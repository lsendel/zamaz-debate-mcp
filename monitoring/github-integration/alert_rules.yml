groups:
- name: github-integration-alerts
  rules:
  - alert: HighCPUUsage
    expr: process_cpu_usage > 0.8
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High CPU usage detected"
      description: "GitHub Integration service is using more than 80% CPU for more than 5 minutes."

  - alert: HighMemoryUsage
    expr: sum(jvm_memory_used_bytes) / sum(jvm_memory_max_bytes) > 0.85
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High memory usage detected"
      description: "GitHub Integration service is using more than 85% of its allocated memory for more than 5 minutes."

  - alert: HighResponseTime
    expr: http_server_requests_seconds_max{uri!~".*actuator.*"} > 2
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: "High response time detected"
      description: "GitHub Integration service has response times greater than 2 seconds for more than 5 minutes."

  - alert: HighErrorRate
    expr: sum(rate(http_server_requests_seconds_count{status=~"5.."}[5m])) / sum(rate(http_server_requests_seconds_count[5m])) > 0.05
    for: 2m
    labels:
      severity: critical
    annotations:
      summary: "High error rate detected"
      description: "GitHub Integration service has more than 5% error rate for more than 2 minutes."

  - alert: InstanceDown
    expr: up{job="github-integration"} == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "Instance down"
      description: "GitHub Integration service is down."

  - alert: DatabaseConnectionFailure
    expr: hikaricp_connections_active == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "Database connection failure"
      description: "GitHub Integration service has no active database connections."

  - alert: RedisConnectionFailure
    expr: redis_connected_clients == 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "Redis connection failure"
      description: "GitHub Integration service has no active Redis connections."