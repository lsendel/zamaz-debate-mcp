<!DOCTYPE html>
<html>
<head>
    <title>Manual UI Test Checklist</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
        }
        .test-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .test-item input[type="checkbox"] {
            margin-right: 10px;
            width: 20px;
            height: 20px;
        }
        .test-item label {
            flex: 1;
            cursor: pointer;
        }
        .status {
            margin-left: 10px;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.pass { background: #d4edda; color: #155724; }
        .status.fail { background: #f8d7da; color: #721c24; }
        .status.pending { background: #fff3cd; color: #856404; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .iframe-container {
            margin: 20px 0;
            border: 2px solid #333;
            border-radius: 4px;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: none;
        }
        .results {
            margin-top: 20px;
            padding: 20px;
            background: #e9ecef;
            border-radius: 4px;
        }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .api-test {
            display: inline-block;
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 Manual UI Test Checklist</h1>
        <p>Test the Debate UI systematically by checking each item below.</p>
        
        <div class="test-section">
            <h2>🔧 Test Controls</h2>
            <button onclick="runAllTests()">Run All API Tests</button>
            <button onclick="resetLocalStorage()">Reset LocalStorage</button>
            <button onclick="checkUIState()">Check UI State</button>
            <button onclick="generateReport()">Generate Report</button>
        </div>

        <div class="test-section">
            <h2>📡 API Status</h2>
            <div id="apiStatus">
                <div class="api-test">
                    <button onclick="testAPI('debate')">Test Debate API</button>
                    <span id="debate-api-status" class="status pending">Pending</span>
                </div>
                <div class="api-test">
                    <button onclick="testAPI('llm')">Test LLM API</button>
                    <span id="llm-api-status" class="status pending">Pending</span>
                </div>
                <div class="api-test">
                    <button onclick="testAPI('health')">Test Health API</button>
                    <span id="health-api-status" class="status pending">Pending</span>
                </div>
            </div>
            <pre id="apiResults"></pre>
        </div>

        <div class="test-section">
            <h2>✅ UI Test Checklist</h2>
            
            <h3>1. Page Load & Header</h3>
            <div class="test-item">
                <input type="checkbox" id="test-1-1">
                <label for="test-1-1">Page loads without errors</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-1-2">
                <label for="test-1-2">Header shows "AI Debate System" title</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-1-3">
                <label for="test-1-3">Organization switcher is visible and not showing skeleton</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-1-4">
                <label for="test-1-4">Test LLM button is visible</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-1-5">
                <label for="test-1-5">New Debate button is visible with gradient</label>
            </div>

            <h3>2. Organization Switcher</h3>
            <div class="test-item">
                <input type="checkbox" id="test-2-1">
                <label for="test-2-1">Clicking organization switcher opens dropdown</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-2-2">
                <label for="test-2-2">Default Organization is shown</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-2-3">
                <label for="test-2-3">Create Organization button works</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-2-4">
                <label for="test-2-4">View History button works</label>
            </div>

            <h3>3. Quick Actions & Stats</h3>
            <div class="test-item">
                <input type="checkbox" id="test-3-1">
                <label for="test-3-1">Quick action cards are visible</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-3-2">
                <label for="test-3-2">Stats cards show correct counts</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-3-3">
                <label for="test-3-3">Stats cards have gradient backgrounds</label>
            </div>

            <h3>4. Tab Navigation</h3>
            <div class="test-item">
                <input type="checkbox" id="test-4-1">
                <label for="test-4-1">All 5 tabs are visible (Debates, Gallery, Library, Active, Setup)</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-4-2">
                <label for="test-4-2">Clicking each tab switches content</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-4-3">
                <label for="test-4-3">Active tab has correct styling</label>
            </div>

            <h3>5. Debates Display</h3>
            <div class="test-item">
                <input type="checkbox" id="test-5-1">
                <label for="test-5-1">Debates tab shows debate cards (not loading spinner)</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-5-2">
                <label for="test-5-2">"Final Test Debate" is visible</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-5-3">
                <label for="test-5-3">Debate cards show participant info</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-5-4">
                <label for="test-5-4">Clicking debate card opens debate view</label>
            </div>

            <h3>6. Create Debate Dialog</h3>
            <div class="test-item">
                <input type="checkbox" id="test-6-1">
                <label for="test-6-1">Clicking New Debate opens dialog</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-6-2">
                <label for="test-6-2">Form fields are visible (name, topic, description)</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-6-3">
                <label for="test-6-3">Add Participant button works</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-6-4">
                <label for="test-6-4">LLM provider dropdown shows options</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-6-5">
                <label for="test-6-5">Model dropdown shows options for selected provider</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-6-6">
                <label for="test-6-6">Dialog can be closed with Escape or X button</label>
            </div>

            <h3>7. Test LLM Dialog</h3>
            <div class="test-item">
                <input type="checkbox" id="test-7-1">
                <label for="test-7-1">Clicking Test LLM opens dialog</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-7-2">
                <label for="test-7-2">Provider selection dropdown works</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-7-3">
                <label for="test-7-3">Model selection updates based on provider</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-7-4">
                <label for="test-7-4">Test prompt field is editable</label>
            </div>

            <h3>8. Connection Status</h3>
            <div class="test-item">
                <input type="checkbox" id="test-8-1">
                <label for="test-8-1">Connection status indicator is visible</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-8-2">
                <label for="test-8-2">Shows correct status (Connected/Disconnected)</label>
            </div>

            <h3>9. Responsive Design</h3>
            <div class="test-item">
                <input type="checkbox" id="test-9-1">
                <label for="test-9-1">UI adapts properly on window resize</label>
            </div>
            <div class="test-item">
                <input type="checkbox" id="test-9-2">
                <label for="test-9-2">Mobile view shows proper layout</label>
            </div>
        </div>

        <div class="test-section">
            <h2>🖼️ Live App View</h2>
            <div class="iframe-container">
                <iframe id="appFrame" src="http://localhost:3001"></iframe>
            </div>
        </div>

        <div class="test-section">
            <h2>📊 Test Results</h2>
            <div class="results" id="results">
                <p>Check items above and click "Generate Report" to see results.</p>
            </div>
        </div>
    </div>

    <script>
        // API test functions
        async function testAPI(type) {
            const statusEl = document.getElementById(`${type}-api-status`);
            statusEl.className = 'status pending';
            statusEl.textContent = 'Testing...';
            
            const endpoints = {
                debate: '/api/debate/resources?uri=debate://debates',
                llm: '/api/llm/providers',
                health: '/api/llm/health'
            };
            
            try {
                const response = await fetch(`http://localhost:3001${endpoints[type]}`);
                const data = await response.json();
                
                statusEl.className = 'status pass';
                statusEl.textContent = 'Pass';
                
                let resultText = '';
                if (type === 'debate') {
                    resultText = `Debates: ${data.debates?.length || 0}`;
                } else if (type === 'llm') {
                    resultText = `Providers: ${data.providers?.length || 0}`;
                } else if (type === 'health') {
                    resultText = `Status: ${data.status}`;
                }
                
                document.getElementById('apiResults').textContent = 
                    `${type.toUpperCase()} API: ${resultText}\n${JSON.stringify(data, null, 2)}`;
                
            } catch (error) {
                statusEl.className = 'status fail';
                statusEl.textContent = 'Fail';
                document.getElementById('apiResults').textContent = 
                    `${type.toUpperCase()} API Error: ${error.message}`;
            }
        }
        
        async function runAllTests() {
            await testAPI('debate');
            await new Promise(r => setTimeout(r, 500));
            await testAPI('llm');
            await new Promise(r => setTimeout(r, 500));
            await testAPI('health');
        }
        
        function resetLocalStorage() {
            const frame = document.getElementById('appFrame').contentWindow;
            frame.localStorage.clear();
            
            // Set default organization
            const defaultOrg = {
                id: 'default-org',
                name: 'Default Organization',
                createdAt: new Date().toISOString(),
                debateCount: 0
            };
            
            frame.localStorage.setItem('organizations', JSON.stringify([defaultOrg]));
            frame.localStorage.setItem('currentOrganizationId', defaultOrg.id);
            
            alert('LocalStorage reset! Reloading app...');
            frame.location.reload();
        }
        
        function checkUIState() {
            const frame = document.getElementById('appFrame').contentWindow;
            const state = {
                localStorage: {
                    currentOrganizationId: frame.localStorage.getItem('currentOrganizationId'),
                    organizations: JSON.parse(frame.localStorage.getItem('organizations') || '[]')
                },
                dom: {
                    hasOrgSwitcher: !!frame.document.querySelector('[aria-expanded]'),
                    hasDebateCards: frame.document.querySelectorAll('[class*="CardTitle"]').length,
                    hasLoadingSpinner: !!frame.document.querySelector('[class*="animate-spin"]')
                }
            };
            
            document.getElementById('results').innerHTML = 
                '<h3>UI State</h3><pre>' + JSON.stringify(state, null, 2) + '</pre>';
        }
        
        function generateReport() {
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const total = checkboxes.length;
            const checked = Array.from(checkboxes).filter(cb => cb.checked).length;
            const percentage = Math.round((checked / total) * 100);
            
            const failedTests = Array.from(checkboxes)
                .filter(cb => !cb.checked)
                .map(cb => cb.nextElementSibling.textContent);
            
            const report = `
<h3>Test Report - ${new Date().toLocaleString()}</h3>
<p><strong>Total Tests:</strong> ${total}</p>
<p><strong>Passed:</strong> ${checked}</p>
<p><strong>Failed:</strong> ${total - checked}</p>
<p><strong>Success Rate:</strong> ${percentage}%</p>

${failedTests.length > 0 ? `
<h4>Failed Tests:</h4>
<ul>
${failedTests.map(test => `<li>${test}</li>`).join('')}
</ul>
` : '<p>✅ All tests passed!</p>'}
            `;
            
            document.getElementById('results').innerHTML = report;
        }
        
        // Auto-run API tests on load
        window.onload = () => {
            setTimeout(runAllTests, 1000);
        };
    </script>
</body>
</html>